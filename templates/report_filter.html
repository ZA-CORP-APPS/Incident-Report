{% extends "base.html" %}

{% block title %}Generate Report{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>Generate Incident Report</h2>
    <p class="text-muted">Filter incidents by any field to generate a comprehensive report</p>
    
    <div class="card">
        <div class="card-body">
            <form method="POST" action="{{ url_for('generate_report') }}">
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="start_date" class="form-label">Start Date</label>
                        <input type="date" class="form-control" id="start_date" name="start_date">
                        <small class="text-muted">Leave blank for no start date filter</small>
                    </div>
                    <div class="col-md-6">
                        <label for="end_date" class="form-label">End Date</label>
                        <input type="date" class="form-control" id="end_date" name="end_date">
                        <small class="text-muted">Leave blank for no end date filter</small>
                    </div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="incident_type" class="form-label">Incident Type</label>
                        <select class="form-select" id="incident_type" name="incident_type">
                            <option value="All">All Types</option>
                            <option value="Security">Security</option>
                            <option value="Safety">Safety</option>
                        </select>
                    </div>
                    <div class="col-md-6">
                        <label for="severity" class="form-label">Severity Level</label>
                        <select class="form-select" id="severity" name="severity">
                            <option value="All">All Severities</option>
                            <option value="Low">Low</option>
                            <option value="Medium">Medium</option>
                            <option value="High">High</option>
                            <option value="Critical">Critical</option>
                        </select>
                    </div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="camera_location" class="form-label">Camera Location</label>
                        <input type="text" class="form-control" id="camera_location" name="camera_location" 
                               list="location-list" placeholder="Enter or select location">
                        <datalist id="location-list">
                            {% for location in locations %}
                            <option value="{{ location }}">
                            {% endfor %}
                        </datalist>
                        <small class="text-muted">Leave blank for all locations</small>
                    </div>
                    <div class="col-md-6">
                        <!-- Empty space for layout -->
                    </div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="reported_by" class="form-label">Reported By</label>
                        <input type="text" class="form-control" id="reported_by" name="reported_by" 
                               list="reporter-list" placeholder="Enter or select reporter">
                        <datalist id="reporter-list">
                            {% for reporter in reporters %}
                            <option value="{{ reporter }}">
                            {% endfor %}
                        </datalist>
                        <small class="text-muted">Leave blank for all reporters</small>
                    </div>
                    <div class="col-md-6">
                        <label for="reviewed_by" class="form-label">Reviewed By</label>
                        <input type="text" class="form-control" id="reviewed_by" name="reviewed_by" 
                               list="reviewer-list" placeholder="Enter or select reviewer">
                        <datalist id="reviewer-list">
                            {% for reviewer in reviewers %}
                            <option value="{{ reviewer }}">
                            {% endfor %}
                        </datalist>
                        <small class="text-muted">Leave blank for all reviewers</small>
                    </div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="persons_involved" class="form-label">Persons Involved</label>
                        <input type="text" class="form-control" id="persons_involved" name="persons_involved" 
                               placeholder="Search persons involved">
                        <small class="text-muted">Partial match search</small>
                    </div>
                    <div class="col-md-6">
                        <label for="description" class="form-label">Description Contains</label>
                        <input type="text" class="form-control" id="description" name="description" 
                               placeholder="Search in description">
                        <small class="text-muted">Partial match search</small>
                    </div>
                </div>
                
                <div class="d-flex gap-2">
                    <button type="submit" class="btn btn-primary">
                        <i class="bi bi-file-earmark-text"></i> Generate Report
                    </button>
                    <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">Cancel</a>
                </div>
            </form>
        </div>
    </div>
    
    <div class="alert alert-info mt-4">
        <strong>Tip:</strong> Leave filters blank to generate a report including all incidents. 
        Use multiple filters to narrow down results (e.g., all Critical incidents from Camera 1 in December 2024).
    </div>
</div>
{% endblock %}
